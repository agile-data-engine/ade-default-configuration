{
  "packageName" : "CONFIG_LOAD_TRANSFORMATIONS",
  "packageVersion" : "1001055",
  "templateVersion" : "1.2",
  "dataPackage" : {
    "packageId" : "f668e8a6-bb0e-4d2a-8231-5d19e8432228",
    "packageName" : "CONFIG_LOAD_TRANSFORMATIONS",
    "packageVersion" : "1001055",
    "createdUser" : "SYSTEM",
    "packageStatus" : "COMMITTED",
    "createdTimestamp" : 1563877530471,
    "modifiedTimestamp" : 1706007250212,
    "modifiedUser" : "harri.pylkkanen@solita.fi",
    "statusChangedTimestamp" : 1705566709079,
    "statusChangedUser" : "harri.pylkkanen@solita.fi",
    "deleted" : false,
    "description" : "#System",
    "packageType" : "CONFIG_PACKAGE"
  },
  "packageDependencies" : [ {
    "packageId" : "6d7d342f-158b-4608-9835-6fa6ea4a9ec0",
    "packageName" : "CONFIG_BASE",
    "packageType" : "CONFIG_PACKAGE",
    "dagLevel" : 1
  } ],
  "attrTransformationTypes" : [ {
    "transformationType" : "CUSTOM",
    "shortDescription" : "Custom SQL expression",
    "description" : "User defined transformation for the attribute in DBMS specific SQL dialect. Can contain environment variables.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 1
  }, {
    "transformationType" : "HASH_KEY",
    "shortDescription" : "Hash key transformation",
    "description" : "Case-insensitive, trimmed, empty strings nulled, nulls converted to '-1', datatypes BOOL, DATE, GEOGRAPHY, TIME, TIMESTAMP, TIMESTAMP_TZ converted to an explicit VARCHAR format, concatenated with '~' as separator, hashed with MD5.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 2
  }, {
    "transformationType" : "HASH_DIFF",
    "shortDescription" : "Hash diff transformation for hash comparison",
    "description" : "Case-sensitive, nulls converted to '-1', datatypes BOOL, DATE, GEOGRAPHY, TIME, TIMESTAMP, TIMESTAMP_TZ converted to an explicit VARCHAR format, concatenated with '~' as separator, hashed with MD5.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 3
  }, {
    "transformationType" : "BUSINESS_KEY",
    "shortDescription" : "Business key transformation",
    "description" : "Case-insensitive, trimmed, empty strings nulled, nulls converted to '-1', datatypes BOOL, DATE, GEOGRAPHY, TIME, TIMESTAMP, TIMESTAMP_TZ converted to an explicit VARCHAR format, concatenated with '~' as separator.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 4
  }, {
    "transformationType" : "CONCAT",
    "shortDescription" : "Concatenation of mapped attributes",
    "description" : "Concatenation of mapped attributes.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 5
  }, {
    "transformationType" : "RUN_ID",
    "shortDescription" : "Unique RUN_ID for each transaction",
    "description" : "Unique RUN_ID for each transaction.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 6
  }, {
    "transformationType" : "CURRENT_TS",
    "shortDescription" : "Current timestamp",
    "description" : "Current timestamp.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 7
  }, {
    "transformationType" : "LOAD_NAME",
    "shortDescription" : "Load name",
    "description" : "Load name.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 8
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "shortDescription" : "Package version",
    "description" : "Package version.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 9
  }, {
    "transformationType" : "DV_STATUS",
    "shortDescription" : "Status satellite activity indicator (1 or 0)",
    "description" : "Status satellite activity indicator (1 or 0).",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 10
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "shortDescription" : "Data Vault DV_RUNNING_ID transformation",
    "description" : "Data Vault DV_RUNNING_ID transformation.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 11
  }, {
    "transformationType" : "HASH_LIST",
    "shortDescription" : "Data Vault HASH list transformation",
    "description" : "Data Vault HASH list transformation.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 12
  }, {
    "transformationType" : "ST_ASTEXT",
    "shortDescription" : "GEOGRAPHY/GEOMETRY to WKT format",
    "description" : "GEOGRAPHY/GEOMETRY to WKT format.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 13
  }, {
    "transformationType" : "ST_ASBINARY",
    "shortDescription" : "GEOGRAPHY/GEOMETRY to WKB format",
    "description" : "GEOGRAPHY/GEOMETRY to WKB format.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 14
  }, {
    "transformationType" : "ST_GEOGFROMTEXT",
    "shortDescription" : "WKT format to GEOGRAPHY",
    "description" : "WKT formatted spatial information to GEOGRAPHY.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 15
  }, {
    "transformationType" : "ST_GEOGFROMWKB",
    "shortDescription" : "WKB format to GEOGRAPHY",
    "description" : "WKB formatted spatial information to GEOGRAPHY.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 16
  }, {
    "transformationType" : "ST_GEOGFROMTEXT_FLAT",
    "shortDescription" : "WKT format to GEOMETRY",
    "description" : "WKT format spatial information to GEOMETRY.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 17
  }, {
    "transformationType" : "ST_GEOGFROMWKB_FLAT",
    "shortDescription" : "WKB format to GEOMETRY",
    "description" : "WKB formatted spatial information to GEOMETRY.",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 18
  }, {
    "transformationType" : "DELETE_TS",
    "shortDescription" : "Deletion timestamp",
    "description" : "Deletion timestamp",
    "isShownInDesigner" : true,
    "ordinalPositionInDesigner" : 19
  }, {
    "transformationType" : "HASH",
    "shortDescription" : "Legacy hash transformation",
    "description" : "Legacy hash transformation.",
    "isShownInDesigner" : false,
    "ordinalPositionInDesigner" : 20
  }, {
    "transformationType" : "DV_BUSINESS_KEY",
    "shortDescription" : "Legacy business key transformation",
    "description" : "Legacy business key transformation.",
    "isShownInDesigner" : false,
    "ordinalPositionInDesigner" : 21
  } ],
  "dbmsTransformationFormulas" : [ {
    "transformationType" : "BUSINESS_KEY",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT64) AS STRING), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        COALESCE(ST_ASTEXT(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"json\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        COALESCE(FORMAT_DATE('%Y-%m-%d',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        COALESCE(FORMAT_TIME('%H:%M:%E6S',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        COALESCE(FORMAT_TIMESTAMP('%Y-%m-%dT%H:%M:%E6S%Ez', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        COALESCE(FORMAT_DATETIME('%Y-%m-%dT%H:%M:%E6S', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"decimal\">\n        COALESCE(TRIM(FORMAT('%${attribute.dataPrecision}.${attribute.dataScale}f', <@prefixHandler prefix/>${attribute.attributeName})), '-1')       \n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        COALESCE(NULLIF(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','),''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n        COALESCE(NULLIF(TO_JSON_STRING(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName})), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"variant\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#else>\n        COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING)), ''), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\" physicalDatatype=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 && physicalDatatype?has_content>\n            CAST(null AS ${physicalDatatype})\n        <#elseif sourceAttributes?size == 0 >\n            null\n        <#elseif sourceAttributes?size == 1 >\n            <@castClouse sourceAttributes[0] prefix/>\n        <#else>\n            CONCAT(<#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next>,'~',</#if></#list>)\n        </#if>\n    </@compress>\n</#macro>\nUPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix physicalDatatype=physicalDatatype/>)"
  }, {
    "transformationType" : "BUSINESS_KEY",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS STRING), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSSxxx\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n            COALESCE(ARRAY_JOIN(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n            COALESCE(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nUPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "BUSINESS_KEY",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nUPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "BUSINESS_KEY",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"geography\">\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}.STAsText()),''), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nUPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "BUSINESS_KEY",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nUPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "BUSINESS_KEY",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            NVL(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geo\")>\n            NVL(ST_AsText(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.USOF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"variant\">\n            NVL(NULLIF(TRIM(JSON_SERIALIZE(<@prefixHandler prefix/>${attribute.attributeName})), ''), '-1')\n        <#else>\n            NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nUPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "BUSINESS_KEY",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE IFF(<@prefixHandler prefix/>${attribute.attributeName}, '1','0') END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE st_astext(<@prefixHandler prefix/>${attribute.attributeName}) END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6TZH:TZM'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        NVL(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n    <#else>\n        NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix>\n    <@compress single_line=true>\n    <#if sourceAttributes?size == 0>\n        null\n    <#else>\n        <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n    </#if>\n    </@compress>\n</#macro>\nUPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "CONCAT",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT64) AS STRING), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        COALESCE(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        COALESCE(ST_ASTEXT(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"json\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        COALESCE(FORMAT_DATE('%Y-%m-%d',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        COALESCE(FORMAT_TIME('%H:%M:%E6S',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        COALESCE(FORMAT_TIMESTAMP('%Y-%m-%dT%H:%M:%E6S%Ez', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        COALESCE(FORMAT_DATETIME('%Y-%m-%dT%H:%M:%E6S', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"decimal\">\n        COALESCE(TRIM(FORMAT('%${attribute.dataPrecision}.${attribute.dataScale}f', <@prefixHandler prefix/>${attribute.attributeName})), '-1')       \n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        COALESCE(NULLIF(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','),''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n        COALESCE(NULLIF(TO_JSON_STRING(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName})), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"variant\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#else>\n        COALESCE(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\" physicalDatatype=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 && physicalDatatype?has_content>\n            CAST(null AS ${physicalDatatype})\n        <#elseif sourceAttributes?size == 0 >\n            null\n        <#elseif sourceAttributes?size == 1 >\n            <@castClouse sourceAttributes[0] prefix/>\n        <#else>\n            CONCAT(<#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next>,'~',</#if></#list>)\n        </#if>\n    </@compress>\n</#macro>\n<#if sourceAttributes?size == 0 && physicalDatatype?has_content>\ncast(null AS ${physicalDatatype})\n<#elseif sourceAttributes?size == 0>\nnull\n<#elseif sourceAttributes?size == 1 >\n<@prefixHandler prefix/>${sourceAttributes[0].attributeName}\n<#else>\n<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix physicalDatatype=physicalDatatype/>\n</#if>"
  }, {
    "transformationType" : "CONCAT",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS STRING), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSSxxx\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n            COALESCE(ARRAY_JOIN(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n            COALESCE(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#if sourceAttributes?size == 0 >\nnull\n<#elseif sourceAttributes?size == 1 >\n<@prefixHandler prefix/>${sourceAttributes[0].attributeName}\n<#else>\n<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix />\n</#if>"
  }, {
    "transformationType" : "CONCAT",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && (attribute.datatype?lower_case == \"char\" || attribute.datatype?lower_case == \"nchar\")>\n            COALESCE(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"varchar\")>\n            COALESCE(<@prefixHandler prefix/>[${attribute.attributeName}], '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#if sourceAttributes?size == 0 >\n    null\n<#elseif sourceAttributes?size == 1 >\n    <@prefixHandler prefix/>[${sourceAttributes[0].attributeName}]\n<#else>\n    <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix />\n</#if>"
  }, {
    "transformationType" : "CONCAT",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && (attribute.datatype?lower_case == \"char\" || attribute.datatype?lower_case == \"nchar\")>\n            COALESCE(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"varchar\")>\n            COALESCE(<@prefixHandler prefix/>[${attribute.attributeName}], '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"geography\">\n            COALESCE(<@prefixHandler prefix/>${attribute.attributeName}.STAsText(), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#if sourceAttributes?size == 0 >\n    null\n<#elseif sourceAttributes?size == 1 >\n    <@prefixHandler prefix/>[${sourceAttributes[0].attributeName}]\n<#else>\n    <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix />\n</#if>"
  }, {
    "transformationType" : "CONCAT",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && (attribute.datatype?lower_case == \"char\" || attribute.datatype?lower_case == \"nchar\")>\n            COALESCE(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"varchar\")>\n            COALESCE(<@prefixHandler prefix/>[${attribute.attributeName}], '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#if sourceAttributes?size == 0 >\n    null\n<#elseif sourceAttributes?size == 1 >\n    <@prefixHandler prefix/>[${sourceAttributes[0].attributeName}]\n<#else>\n    <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix />\n</#if>"
  }, {
    "transformationType" : "CONCAT",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            NVL(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            NVL(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geo\")>\n            NVL(ST_AsText(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.USOF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"variant\">\n            NVL(JSON_SERIALIZE(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            NVL(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#if sourceAttributes?size == 0 >\n    null\n<#elseif sourceAttributes?size == 1 >\n    <@prefixHandler prefix/>${sourceAttributes[0].attributeName}\n<#else>\n    <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix />\n</#if>"
  }, {
    "transformationType" : "CONCAT",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE IFF(<@prefixHandler prefix/>${attribute.attributeName}, '1','0') END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        NVL(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE st_astext(<@prefixHandler prefix/>${attribute.attributeName}) END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6TZH:TZM'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        NVL(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n    <#else>\n        NVL(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix>\n    <@compress single_line=true>\n    <#if sourceAttributes?size == 0>\n        null\n    <#else>\n        <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n    </#if>\n    </@compress>\n</#macro>\n<#if sourceAttributes?size == 0 >\nnull\n<#elseif sourceAttributes?size == 1 >\n<@prefixHandler prefix/>${sourceAttributes[0].attributeName}\n<#else>\n<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix />\n</#if>"
  }, {
    "transformationType" : "CURRENT_TS",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "CURRENT_DATETIME()"
  }, {
    "transformationType" : "CURRENT_TS",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "CURRENT_TIMESTAMP()"
  }, {
    "transformationType" : "CURRENT_TS",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "SYSUTCDATETIME()"
  }, {
    "transformationType" : "CURRENT_TS",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "SYSUTCDATETIME()"
  }, {
    "transformationType" : "CURRENT_TS",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "SYSUTCDATETIME()"
  }, {
    "transformationType" : "CURRENT_TS",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "SYSDATE"
  }, {
    "transformationType" : "CURRENT_TS",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "SYSDATE()"
  }, {
    "transformationType" : "DELETE_TS",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>COALESCE(<@prefixHandler prefix/>${attributeName}, CURRENT_DATETIME())"
  }, {
    "transformationType" : "DELETE_TS",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>COALESCE(<@prefixHandler prefix/>${attributeName}, CURRENT_TIMESTAMP())"
  }, {
    "transformationType" : "DELETE_TS",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>COALESCE(<@prefixHandler prefix/>[${attributeName}], SYSUTCDATETIME())"
  }, {
    "transformationType" : "DELETE_TS",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>COALESCE(<@prefixHandler prefix/>[${attributeName}], SYSUTCDATETIME())"
  }, {
    "transformationType" : "DELETE_TS",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>COALESCE(<@prefixHandler prefix/>[${attributeName}], SYSUTCDATETIME())"
  }, {
    "transformationType" : "DELETE_TS",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro> NVL(<@prefixHandler prefix/>${attributeName}, SYSDATE)"
  }, {
    "transformationType" : "DELETE_TS",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>COALESCE(<@prefixHandler prefix/>${attributeName}, SYSDATE())"
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT64) AS STRING), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        COALESCE(ST_ASTEXT(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"json\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        COALESCE(FORMAT_DATE('%Y-%m-%d',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        COALESCE(FORMAT_TIME('%H:%M:%E6S',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        COALESCE(FORMAT_TIMESTAMP('%Y-%m-%dT%H:%M:%E6S%Ez', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        COALESCE(FORMAT_DATETIME('%Y-%m-%dT%H:%M:%E6S', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"decimal\">\n        COALESCE(TRIM(FORMAT('%${attribute.dataPrecision}.${attribute.dataScale}f', <@prefixHandler prefix/>${attribute.attributeName})), '-1')       \n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        COALESCE(NULLIF(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','),''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n        COALESCE(NULLIF(TO_JSON_STRING(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName})), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"variant\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#else>\n        COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING)), ''), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\" physicalDatatype=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 && physicalDatatype?has_content>\n            CAST(null AS ${physicalDatatype})\n        <#elseif sourceAttributes?size == 0 >\n            null\n        <#elseif sourceAttributes?size == 1 >\n            <@castClouse sourceAttributes[0] prefix/>\n        <#else>\n            CONCAT(<#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next>,'~',</#if></#list>)\n        </#if>\n    </@compress>\n</#macro>\nROW_NUMBER() OVER (\n    PARTITION BY TO_HEX(MD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix physicalDatatype=physicalDatatype/>)))\n    ORDER BY UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))"
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS STRING), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSSxxx\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n            COALESCE(ARRAY_JOIN(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n            COALESCE(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nROW_NUMBER() OVER (\n    PARTITION BY MD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))\n    ORDER BY UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n)"
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#macro businessKeyFunction sourceAttributes prefix>\n    <@compress single_line=true>\n    UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    </@compress>\n</#macro>\n<#macro hashFunction sourceAttributes prefix>\n    <@compress single_line=true>\n    LOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5',<@businessKeyFunction sourceAttributes=sourceAttributes prefix=prefix/>),2))\n    </@compress>\n</#macro>\n<@compress single_line=true>\n    ROW_NUMBER() OVER (\n        PARTITION BY <@hashFunction sourceAttributes=sourceAttributes prefix=prefix/>\n        ORDER BY <@businessKeyFunction sourceAttributes=sourceAttributes prefix=prefix/>)\n</@compress>"
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"geography\">\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}.STAsText()),''), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#macro businessKeyFunction sourceAttributes prefix>\n    <@compress single_line=true>\n    UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    </@compress>\n</#macro>\n<#macro hashFunction sourceAttributes prefix>\n    <@compress single_line=true>\n    LOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5',<@businessKeyFunction sourceAttributes=sourceAttributes prefix=prefix/>),2))\n    </@compress>\n</#macro>\n<@compress single_line=true>\n    ROW_NUMBER() OVER (\n        PARTITION BY <@hashFunction sourceAttributes=sourceAttributes prefix=prefix/>\n        ORDER BY <@businessKeyFunction sourceAttributes=sourceAttributes prefix=prefix/>)\n</@compress>"
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#macro businessKeyFunction sourceAttributes prefix>\n    <@compress single_line=true>\n    UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    </@compress>\n</#macro>\n<#macro hashFunction sourceAttributes prefix>\n    <@compress single_line=true>\n    LOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5',<@businessKeyFunction sourceAttributes=sourceAttributes prefix=prefix/>),2))\n    </@compress>\n</#macro>\n<@compress single_line=true>\n    ROW_NUMBER() OVER (\n        PARTITION BY <@hashFunction sourceAttributes=sourceAttributes prefix=prefix/>\n        ORDER BY <@businessKeyFunction sourceAttributes=sourceAttributes prefix=prefix/>)\n</@compress>"
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            NVL(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geo\")>\n            NVL(ST_AsText(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.USOF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"variant\">\n            NVL(NULLIF(TRIM(JSON_SERIALIZE(<@prefixHandler prefix/>${attribute.attributeName})), ''), '-1')\n        <#else>\n            NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nROW_NUMBER() OVER (\n    PARTITION BY MD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))\n    ORDER BY UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))"
  }, {
    "transformationType" : "DV_RUNNING_ID",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE IFF(<@prefixHandler prefix/>${attribute.attributeName}, '1','0') END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE st_astext(<@prefixHandler prefix/>${attribute.attributeName}) END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6TZHTZM'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        NVL(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n    <#else>\n        NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix>\n    <@compress single_line=true>\n    <#if sourceAttributes?size == 0>\n        null\n    <#else>\n        <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n    </#if>\n    </@compress>\n</#macro>\nROW_NUMBER() OVER (\n    PARTITION BY MD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))\n    ORDER BY UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))"
  }, {
    "transformationType" : "HASH_DIFF",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT64) AS STRING), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        COALESCE(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        COALESCE(ST_ASTEXT(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"json\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        COALESCE(FORMAT_DATE('%Y-%m-%d',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        COALESCE(FORMAT_TIME('%H:%M:%E6S',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        COALESCE(FORMAT_TIMESTAMP('%Y-%m-%dT%H:%M:%E6S%Ez', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        COALESCE(FORMAT_DATETIME('%Y-%m-%dT%H:%M:%E6S', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"decimal\">\n        COALESCE(TRIM(FORMAT('%${attribute.dataPrecision}.${attribute.dataScale}f', <@prefixHandler prefix/>${attribute.attributeName})), '-1')       \n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        COALESCE(NULLIF(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','),''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n        COALESCE(NULLIF(TO_JSON_STRING(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName})), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"variant\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#else>\n        COALESCE(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\" physicalDatatype=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 && physicalDatatype?has_content>\n            CAST(null AS ${physicalDatatype})\n        <#elseif sourceAttributes?size == 0 >\n            null\n        <#elseif sourceAttributes?size == 1 >\n            <@castClouse sourceAttributes[0] prefix/>\n        <#else>\n            CONCAT(<#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next>,'~',</#if></#list>)\n        </#if>\n    </@compress>\n</#macro>\nTO_HEX(MD5(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix physicalDatatype=physicalDatatype/>))\n\n"
  }, {
    "transformationType" : "HASH_DIFF",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS STRING), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSSxxx\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n            COALESCE(ARRAY_JOIN(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n            COALESCE(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nMD5(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "HASH_DIFF",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && (attribute.datatype?lower_case == \"char\" || attribute.datatype?lower_case == \"nchar\")>\n            COALESCE(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"varchar\")>\n            COALESCE(<@prefixHandler prefix/>[${attribute.attributeName}], '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nLOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5', <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>),2))"
  }, {
    "transformationType" : "HASH_DIFF",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && (attribute.datatype?lower_case == \"char\" || attribute.datatype?lower_case == \"nchar\")>\n            COALESCE(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"varchar\")>\n            COALESCE(<@prefixHandler prefix/>[${attribute.attributeName}], '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"geography\">\n            COALESCE(<@prefixHandler prefix/>${attribute.attributeName}.STAsText(), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nLOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5', <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>),2))"
  }, {
    "transformationType" : "HASH_DIFF",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && (attribute.datatype?lower_case == \"char\" || attribute.datatype?lower_case == \"nchar\")>\n            COALESCE(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"varchar\")>\n            COALESCE(<@prefixHandler prefix/>[${attribute.attributeName}], '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nLOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5', <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>),2))"
  }, {
    "transformationType" : "HASH_DIFF",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            NVL(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            NVL(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geo\")>\n            NVL(ST_AsText(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.USOF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"variant\">\n            NVL(JSON_SERIALIZE(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            NVL(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nMD5(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "HASH_DIFF",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE IFF(<@prefixHandler prefix/>${attribute.attributeName}, '1','0') END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        NVL(<@prefixHandler prefix/>${attribute.attributeName}, '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE st_astext(<@prefixHandler prefix/>${attribute.attributeName}) END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6TZH:TZM'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        NVL(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n    <#else>\n        NVL(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix>\n    <@compress single_line=true>\n    <#if sourceAttributes?size == 0>\n        null\n    <#else>\n        <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n    </#if>\n    </@compress>\n</#macro>\nMD5(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)"
  }, {
    "transformationType" : "HASH_KEY",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT64) AS STRING), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        COALESCE(ST_ASTEXT(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"json\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        COALESCE(FORMAT_DATE('%Y-%m-%d',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        COALESCE(FORMAT_TIME('%H:%M:%E6S',<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        COALESCE(FORMAT_TIMESTAMP('%Y-%m-%dT%H:%M:%E6S%Ez', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        COALESCE(FORMAT_DATETIME('%Y-%m-%dT%H:%M:%E6S', <@prefixHandler prefix/>${attribute.attributeName}), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"decimal\">\n        COALESCE(TRIM(FORMAT('%${attribute.dataPrecision}.${attribute.dataScale}f', <@prefixHandler prefix/>${attribute.attributeName})), '-1')       \n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        COALESCE(NULLIF(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','),''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n        COALESCE(NULLIF(TO_JSON_STRING(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName})), 'null'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"variant\")>\n        COALESCE(NULLIF(TO_JSON_STRING(<@prefixHandler prefix/>${attribute.attributeName}), 'null'), '-1')\n    <#else>\n        COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING)), ''), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\" physicalDatatype=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 && physicalDatatype?has_content>\n            CAST(null AS ${physicalDatatype})\n        <#elseif sourceAttributes?size == 0 >\n            null\n        <#elseif sourceAttributes?size == 1 >\n            <@castClouse sourceAttributes[0] prefix/>\n        <#else>\n            CONCAT(<#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next>,'~',</#if></#list>)\n        </#if>\n    </@compress>\n</#macro>\nTO_HEX(MD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix physicalDatatype=physicalDatatype/>)))"
  }, {
    "transformationType" : "HASH_KEY",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS STRING), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSSxxx\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n            COALESCE(ARRAY_JOIN(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n            COALESCE(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nMD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))"
  }, {
    "transformationType" : "HASH_KEY",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nLOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5', UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)),2))"
  }, {
    "transformationType" : "HASH_KEY",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"geography\">\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}.STAsText()),''), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nLOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5', UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)),2))"
  }, {
    "transformationType" : "HASH_KEY",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nLOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5', UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)),2))"
  }, {
    "transformationType" : "HASH_KEY",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            NVL(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geo\")>\n            NVL(ST_AsText(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.USOF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"variant\">\n            NVL(NULLIF(TRIM(JSON_SERIALIZE(<@prefixHandler prefix/>${attribute.attributeName})), ''), '-1')\n        <#else>\n            NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nMD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))"
  }, {
    "transformationType" : "HASH_KEY",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE IFF(<@prefixHandler prefix/>${attribute.attributeName}, '1','0') END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE st_astext(<@prefixHandler prefix/>${attribute.attributeName}) END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6TZH:TZM'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        NVL(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n    <#else>\n        NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix>\n    <@compress single_line=true>\n    <#if sourceAttributes?size == 0>\n        null\n    <#else>\n        <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n    </#if>\n    </@compress>\n</#macro>\nMD5(UPPER(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>))"
  }, {
    "transformationType" : "HASH_LIST",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "hash_list.datahash_list"
  }, {
    "transformationType" : "HASH_LIST",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS STRING), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSS\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(DATE_FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, \"yyyy-MM-dd['T']kk:mm:ss.SSSSSSxxx\"), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n            COALESCE(ARRAY_JOIN(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"struct\")>\n            COALESCE(TO_JSON(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS STRING)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nMD5(ARRAY_JOIN(ARRAY_AGG(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    OVER (PARTITION BY <@sourceAttributeList sourceAttributes=keyAttributeList prefix=prefix/>\n          ORDER BY <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>\n          RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n    ), '~'))"
  }, {
    "transformationType" : "HASH_LIST",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#macro indent level content='' ending=''>\n<#local indentSize=4/><#lt><#rt>\n${''?left_pad(level*indentSize)}${content?replace('\\\\s*\\\\Z', '','r')?replace('(\\r\\n)+|(\\n)+', '\\n'?right_pad(level*indentSize+1),'r')}${ending}\n</#macro>\n<#macro encapsulateValue value><#if value?length &gt;0>[${value?trim}]</#if></#macro>\n<#macro cleanSchema schemaName><#if schemaName?? && schemaName?length &gt; 0>${schemaName?replace(\"\\\\[|\\\\]\",\"\",'r')}</#if></#macro>\n<#macro encapsulateAllParts entity>\n    <#local processedEntity=\"\">\n    <#list entity?split(\".\") as entityPart>\n        <#local processedEntity>\n            <#compress>${processedEntity}<#if !entityPart?is_first>.</#if><@encapsulateValue value=entityPart/></#compress>\n        </#local>\n    </#list>\n    <#if processedEntity?length &gt; 0>\n    <#local processedEntity>${processedEntity}.</#local>\n    </#if>\n    <@compress single_line=true>\n    ${processedEntity?replace(\"^\\\\s+|\\\\s+$|\\\\n|\\\\r\", \"\", \"rm\")}\n    </@compress>\n</#macro>\n<#macro entityNameResolver schemaName entityName>\n    <@compress single_line=true>\n    <@encapsulateAllParts entity=schemaName/><@encapsulateValue value=entityName/>\n    </@compress>\n</#macro>\n<#function loadOptWhereCondition loadOptDefined loadOpt >\n    <#if loadOptDefined(\"OPT_WHERE\")>\n        <#return [\"${loadOpt(\\\"OPT_WHERE\\\")}\"]>\n    </#if>\n    <#return []>\n</#function>\n<#function batchCondition useBatchLoading sourceEntity prefix=\"\">\n    <#if useBatchLoading>\n        <#local batchHandling><#if prefix?length &gt; 0>${prefix}.</#if><sourcerunidattr></#local>\n        <#if sourceEntity.containsRunIdAttribute>\n            <#local batchHandling><#if prefix?length &gt; 0>${prefix}.</#if>[${sourceEntity.runIdAttributeName}]</#local>\n        </#if>\n        <#return [\"${batchHandling} IN (<loadablerunids>)\"]>\n    </#if>\n    <#return []>\n</#function>\n<#function batchAndWhereCondition useBatchLoading sourceEntity loadOptDefined loadOpt prefix=\"\">\n    <#local whereCondition = batchCondition(useBatchLoading sourceEntity prefix)/>\n    <#local whereCondition += loadOptWhereCondition(loadOptDefined loadOpt)>\n    <#return whereCondition>\n</#function>\n<#macro whereClause conditions indentation=0 >\n    <#if conditions?has_content>\n        <@indent level=indentation content=\"WHERE\" />\n        <#list conditions as condition>\n            <@indent level=indentation+1 content=\"${condition?is_first?then('', 'AND\\n')}${condition}\" />\n        </#list>\n    </#if>\n</#macro>\n<#macro collectWhereClause useBatchLoading sourceEntity loadOptDefined loadOpt keyAttributeList>\n    <#local valueListAlias=\"value_list\">\n    <#local srcEntityAlias=\"src_entity\">\n    <#local whereCondition=batchAndWhereCondition(useBatchLoading sourceEntity loadOptDefined loadOpt valueListAlias)>\n    <#list keyAttributeList as keyAttribute>\n        <#local keyAttributeMatch><@castClouse keyAttribute valueListAlias/>=<@castClouse keyAttribute srcEntityAlias/></#local>\n        <#local whereCondition += [\"${keyAttributeMatch}\"]>\n    </#list>\n    <@whereClause conditions=whereCondition indentation=indentation/>\n</#macro>\n(\n    SELECT LOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5',\n    STRING_AGG(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>,'~')\n    WITHIN GROUP (ORDER BY <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    ),2))\n    FROM <@entityNameResolver schemaName=sourceEntity.owner entityName=sourceEntity.entityName/> value_list\n    <@collectWhereClause useBatchLoading=useBatchLoading sourceEntity=sourceEntity loadOptDefined=loadOptDefined loadOpt=loadOpt keyAttributeList=keyAttributeList/>\n)"
  }, {
    "transformationType" : "HASH_LIST",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"geography\">\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}.STAsText()),''), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#macro indent level content='' ending=''>\n<#local indentSize=4/><#lt><#rt>\n${''?left_pad(level*indentSize)}${content?replace('\\\\s*\\\\Z', '','r')?replace('(\\r\\n)+|(\\n)+', '\\n'?right_pad(level*indentSize+1),'r')}${ending}\n</#macro>\n<#macro encapsulateValue value><#if value?length &gt;0>[${value?trim}]</#if></#macro>\n<#macro cleanSchema schemaName><#if schemaName?? && schemaName?length &gt; 0>${schemaName?replace(\"\\\\[|\\\\]\",\"\",'r')}</#if></#macro>\n<#macro encapsulateAllParts entity>\n    <#local processedEntity=\"\">\n    <#list entity?split(\".\") as entityPart>\n        <#local processedEntity>\n            <#compress>${processedEntity}<#if !entityPart?is_first>.</#if><@encapsulateValue value=entityPart/></#compress>\n        </#local>\n    </#list>\n    <#if processedEntity?length &gt; 0>\n    <#local processedEntity>${processedEntity}.</#local>\n    </#if>\n    <@compress single_line=true>\n    ${processedEntity?replace(\"^\\\\s+|\\\\s+$|\\\\n|\\\\r\", \"\", \"rm\")}\n    </@compress>\n</#macro>\n<#macro entityNameResolver schemaName entityName>\n    <@compress single_line=true>\n    <@encapsulateAllParts entity=schemaName/><@encapsulateValue value=entityName/>\n    </@compress>\n</#macro>\n<#function loadOptWhereCondition loadOptDefined loadOpt >\n    <#if loadOptDefined(\"OPT_WHERE\")>\n        <#return [\"${loadOpt(\\\"OPT_WHERE\\\")}\"]>\n    </#if>\n    <#return []>\n</#function>\n<#function batchCondition useBatchLoading sourceEntity prefix=\"\">\n    <#if useBatchLoading>\n        <#local batchHandling><#if prefix?length &gt; 0>${prefix}.</#if><sourcerunidattr></#local>\n        <#if sourceEntity.containsRunIdAttribute>\n            <#local batchHandling><#if prefix?length &gt; 0>${prefix}.</#if>[${sourceEntity.runIdAttributeName}]</#local>\n        </#if>\n        <#return [\"${batchHandling} IN (<loadablerunids>)\"]>\n    </#if>\n    <#return []>\n</#function>\n<#function batchAndWhereCondition useBatchLoading sourceEntity loadOptDefined loadOpt prefix=\"\">\n    <#local whereCondition = batchCondition(useBatchLoading sourceEntity prefix)/>\n    <#local whereCondition += loadOptWhereCondition(loadOptDefined loadOpt)>\n    <#return whereCondition>\n</#function>\n<#macro whereClause conditions indentation=0 >\n    <#if conditions?has_content>\n        <@indent level=indentation content=\"WHERE\" />\n        <#list conditions as condition>\n            <@indent level=indentation+1 content=\"${condition?is_first?then('', 'AND\\n')}${condition}\" />\n        </#list>\n    </#if>\n</#macro>\n<#macro collectWhereClause useBatchLoading sourceEntity loadOptDefined loadOpt keyAttributeList>\n    <#local valueListAlias=\"value_list\">\n    <#local srcEntityAlias=\"src_entity\">\n    <#local whereCondition=batchAndWhereCondition(useBatchLoading sourceEntity loadOptDefined loadOpt valueListAlias)>\n    <#list keyAttributeList as keyAttribute>\n        <#local keyAttributeMatch><@castClouse keyAttribute valueListAlias/>=<@castClouse keyAttribute srcEntityAlias/></#local>\n        <#local whereCondition += [\"${keyAttributeMatch}\"]>\n    </#list>\n    <@whereClause conditions=whereCondition indentation=indentation/>\n</#macro>\n(\n    SELECT LOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5',\n    STRING_AGG(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>,'~')\n    WITHIN GROUP (ORDER BY <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    ),2))\n    FROM <@entityNameResolver schemaName=sourceEntity.owner entityName=sourceEntity.entityName/> value_list\n    <@collectWhereClause useBatchLoading=useBatchLoading sourceEntity=sourceEntity loadOptDefined=loadOptDefined loadOpt=loadOpt keyAttributeList=keyAttributeList/>\n)"
  }, {
    "transformationType" : "HASH_LIST",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            COALESCE(NULLIF(TRIM(<@prefixHandler prefix/>[${attribute.attributeName}]), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            COALESCE(CAST(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-dd'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'hh\\:mm\\:ss\\.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            COALESCE(FORMAT(<@prefixHandler prefix/>${attribute.attributeName}, 'yyyy-MM-ddTHH:mm:ss.FFFFFFzzz'), '-1')\n        <#else>\n            COALESCE(NULLIF(TRIM(CAST(<@prefixHandler prefix/>[${attribute.attributeName}] AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> + '~' + </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\n<#macro indent level content='' ending=''>\n<#local indentSize=4/><#lt><#rt>\n${''?left_pad(level*indentSize)}${content?replace('\\\\s*\\\\Z', '','r')?replace('(\\r\\n)+|(\\n)+', '\\n'?right_pad(level*indentSize+1),'r')}${ending}\n</#macro>\n<#macro encapsulateValue value><#if value?length &gt;0>[${value?trim}]</#if></#macro>\n<#macro cleanSchema schemaName><#if schemaName?? && schemaName?length &gt; 0>${schemaName?replace(\"\\\\[|\\\\]\",\"\",'r')}</#if></#macro>\n<#macro encapsulateAllParts entity>\n    <#local processedEntity=\"\">\n    <#list entity?split(\".\") as entityPart>\n        <#local processedEntity>\n            <#compress>${processedEntity}<#if !entityPart?is_first>.</#if><@encapsulateValue value=entityPart/></#compress>\n        </#local>\n    </#list>\n    <#if processedEntity?length &gt; 0>\n    <#local processedEntity>${processedEntity}.</#local>\n    </#if>\n    <@compress single_line=true>\n    ${processedEntity?replace(\"^\\\\s+|\\\\s+$|\\\\n|\\\\r\", \"\", \"rm\")}\n    </@compress>\n</#macro>\n<#macro entityNameResolver schemaName entityName>\n    <@compress single_line=true>\n    <@encapsulateAllParts entity=schemaName/><@encapsulateValue value=entityName/>\n    </@compress>\n</#macro>\n<#function loadOptWhereCondition loadOptDefined loadOpt >\n    <#if loadOptDefined(\"OPT_WHERE\")>\n        <#return [\"${loadOpt(\\\"OPT_WHERE\\\")}\"]>\n    </#if>\n    <#return []>\n</#function>\n<#function batchCondition useBatchLoading sourceEntity prefix=\"\">\n    <#if useBatchLoading>\n        <#local batchHandling><#if prefix?length &gt; 0>${prefix}.</#if><sourcerunidattr></#local>\n        <#if sourceEntity.containsRunIdAttribute>\n            <#local batchHandling><#if prefix?length &gt; 0>${prefix}.</#if>[${sourceEntity.runIdAttributeName}]</#local>\n        </#if>\n        <#return [\"${batchHandling} IN (<loadablerunids>)\"]>\n    </#if>\n    <#return []>\n</#function>\n<#function batchAndWhereCondition useBatchLoading sourceEntity loadOptDefined loadOpt prefix=\"\">\n    <#local whereCondition = batchCondition(useBatchLoading sourceEntity prefix)/>\n    <#local whereCondition += loadOptWhereCondition(loadOptDefined loadOpt)>\n    <#return whereCondition>\n</#function>\n<#macro whereClause conditions indentation=0 >\n    <#if conditions?has_content>\n        <@indent level=indentation content=\"WHERE\" />\n        <#list conditions as condition>\n            <@indent level=indentation+1 content=\"${condition?is_first?then('', 'AND\\n')}${condition}\" />\n        </#list>\n    </#if>\n</#macro>\n<#macro collectWhereClause useBatchLoading sourceEntity loadOptDefined loadOpt keyAttributeList>\n    <#local valueListAlias=\"value_list\">\n    <#local srcEntityAlias=\"src_entity\">\n    <#local whereCondition=batchAndWhereCondition(useBatchLoading sourceEntity loadOptDefined loadOpt valueListAlias)>\n    <#list keyAttributeList as keyAttribute>\n        <#local keyAttributeMatch><@castClouse keyAttribute valueListAlias/>=<@castClouse keyAttribute srcEntityAlias/></#local>\n        <#local whereCondition += [\"${keyAttributeMatch}\"]>\n    </#list>\n    <@whereClause conditions=whereCondition indentation=indentation/>\n</#macro>\n(\n    SELECT LOWER(CONVERT(VARCHAR(32),HASHBYTES('MD5',\n    STRING_AGG(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>,'~')\n    WITHIN GROUP (ORDER BY <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    ),2))\n    FROM <@entityNameResolver schemaName=sourceEntity.owner entityName=sourceEntity.entityName/> value_list\n    <@collectWhereClause useBatchLoading=useBatchLoading sourceEntity=sourceEntity loadOptDefined=loadOptDefined loadOpt=loadOpt keyAttributeList=keyAttributeList/>\n)"
  }, {
    "transformationType" : "HASH_LIST",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <@compress single_line=true>\n        <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n            NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n            NVL(CAST(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS INT) AS VARCHAR), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geo\")>\n            NVL(ST_AsText(<@prefixHandler prefix/>${attribute.attributeName}), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.US'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n            NVL(TO_CHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD\"T\"HH24:MI:SS.USOF'), '-1')\n        <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"variant\">\n            NVL(NULLIF(TRIM(JSON_SERIALIZE(<@prefixHandler prefix/>${attribute.attributeName})), ''), '-1')\n        <#else>\n            NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n        </#if>\n    </@compress>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix=\"\">\n    <@compress single_line=true>\n        <#if sourceAttributes?size == 0 >\n            null\n        <#else>\n            <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n        </#if>\n    </@compress>\n</#macro>\nMD5(LISTAGG(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>, '~')\n    WITHIN GROUP (ORDER BY <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>)\n    OVER (PARTITION BY <@sourceAttributeList sourceAttributes=keyAttributeList prefix=prefix/> ))"
  }, {
    "transformationType" : "HASH_LIST",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<#macro prefixHandler prefix><#if prefix?? && prefix?length &gt; 0>${prefix}.</#if></#macro>\n<#macro castClouse attribute prefix>\n    <#if attribute.datatype?? && attribute.datatype?lower_case?contains(\"bool\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE IFF(<@prefixHandler prefix/>${attribute.attributeName}, '1','0') END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"char\")>\n        NVL(NULLIF(TRIM(<@prefixHandler prefix/>${attribute.attributeName}), ''), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"date\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DD'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"geography\")>\n        CASE WHEN ${attribute.attributeName} IS NULL THEN '-1' ELSE st_astext(<@prefixHandler prefix/>${attribute.attributeName}) END\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"time\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'HH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case == \"timestamp_tz\">\n        NVL(TO_VARCHAR(<@prefixHandler prefix/>${attribute.attributeName}, 'YYYY-MM-DDTHH24:MI:SS.FF6TZH:TZM'), '-1')\n    <#elseif attribute.datatype?? && attribute.datatype?lower_case?contains(\"array\")>\n        NVL(ARRAY_TO_STRING(<@prefixHandler prefix/>${attribute.attributeName},','), '-1')\n    <#else>\n        NVL(NULLIF(TRIM(CAST(<@prefixHandler prefix/>${attribute.attributeName} AS VARCHAR)), ''), '-1')\n    </#if>\n</#macro>\n<#macro sourceAttributeList sourceAttributes prefix>\n    <@compress single_line=true>\n    <#if sourceAttributes?size == 0>\n        null\n    <#else>\n        <#list sourceAttributes as attribute><@castClouse attribute prefix/><#if attribute_has_next> || '~' || </#if></#list>\n    </#if>\n    </@compress>\n</#macro>\nMD5(LISTAGG(<@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/>, '~')\n    WITHIN GROUP (ORDER BY <@sourceAttributeList sourceAttributes=sourceAttributes prefix=prefix/> )\n    OVER (PARTITION BY <@sourceAttributeList sourceAttributes=keyAttributeList prefix=prefix/> ))"
  }, {
    "transformationType" : "LOAD_NAME",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "'<loadname>'"
  }, {
    "transformationType" : "LOAD_NAME",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "'<loadname>'"
  }, {
    "transformationType" : "LOAD_NAME",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "'<loadname>'"
  }, {
    "transformationType" : "LOAD_NAME",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "'<loadname>'"
  }, {
    "transformationType" : "LOAD_NAME",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "'<loadname>'"
  }, {
    "transformationType" : "LOAD_NAME",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "'<loadname>'"
  }, {
    "transformationType" : "LOAD_NAME",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "'<loadname>'"
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "dbmsProduct" : "BIGQUERY",
    "transformationFormula" : "<packageversion>"
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "dbmsProduct" : "DATABRICKS",
    "transformationFormula" : "<packageversion>"
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "dbmsProduct" : "MS_FABRIC",
    "transformationFormula" : "<packageversion>"
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "dbmsProduct" : "MS_SQL",
    "transformationFormula" : "<packageversion>"
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "dbmsProduct" : "MS_SQL_DW",
    "transformationFormula" : "<packageversion>"
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "dbmsProduct" : "REDSHIFT",
    "transformationFormula" : "<packageversion>"
  }, {
    "transformationType" : "PACKAGE_VERSION",
    "dbmsProduct" : "SNOWFLAKE",
    "transformationFormula" : "<packageversion>"
  } ]
}